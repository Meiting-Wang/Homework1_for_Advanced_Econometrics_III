\begin{lstlisting}
use nls80.dta, clear

local x "exper tenure married south urban black"
local zh "kww meduc feduc sibs"

*test rank condition
qui reg educ `x' `zh', vce(robust)
test `zh'
qui reg iq `x' `zh', vce(robust)
test `zh'

*output the regression result
eststo clear
eststo: reg lwage `x' educ iq, vce(robust)
eststo: ivregress 2sls lwage `x' (educ iq=`zh'), vce(robust)
esttab *, b(3) se(3) star(* 0.10 ** 0.05 *** 0.01) r2 obslast compress nogaps mti("OLS" "2SLS") order(educ iq)
\end{lstlisting}